/**
 * @preserve FastClick: polyfill to remove click delays on browsers with touch UIs.
 *
 * @version 0.4.3
 * @codingstandard ftlabs-jslint
 * @copyright The Financial Times Limited [All Rights Reserved]
 * @license MIT License (see LICENSE.txt)
 */
/*jslint browser:true, node:true*/
/*global define*/
/**
 * Instantiate fast-clicking listeners on the specificed layer.
 *
 * @constructor
 * @param {Element} layer The layer to listen on
 */
function FastClick(e){"use strict";var t,n=this;this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.layer=e;if(!e||!e.nodeType)throw new TypeError("Layer must be a document node");this.onClick=function(){FastClick.prototype.onClick.apply(n,arguments)},this.onTouchStart=function(){FastClick.prototype.onTouchStart.apply(n,arguments)},this.onTouchMove=function(){FastClick.prototype.onTouchMove.apply(n,arguments)},this.onTouchEnd=function(){FastClick.prototype.onTouchEnd.apply(n,arguments)},this.onTouchCancel=function(){FastClick.prototype.onTouchCancel.apply(n,arguments)};if(typeof window.ontouchstart=="undefined")return;e.addEventListener("click",this.onClick,!0),e.addEventListener("touchstart",this.onTouchStart,!1),e.addEventListener("touchmove",this.onTouchMove,!1),e.addEventListener("touchend",this.onTouchEnd,!1),e.addEventListener("touchcancel",this.onTouchCancel,!1),typeof e.onclick=="function"&&(t=e.onclick,e.addEventListener("click",function(e){t(e)},!1),e.onclick=null)}FastClick.prototype.deviceIsAndroid=navigator.userAgent.indexOf("Android")>0,FastClick.prototype.needsClick=function(e){"use strict";switch(e.nodeName.toLowerCase()){case"label":case"video":return!0;default:return/\bneedsclick\b/.test(e.className)}},FastClick.prototype.needsFocus=function(e){"use strict";switch(e.nodeName.toLowerCase()){case"textarea":case"select":return!0;case"input":switch(e.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!0;default:return/\bneedsfocus\b/.test(e.className)}},FastClick.prototype.maybeSendClick=function(e,t){"use strict";var n,r;return this.needsClick(e)?!1:(document.activeElement&&document.activeElement!==e&&document.activeElement.blur(),r=t.changedTouches[0],n=document.createEvent("MouseEvents"),n.initMouseEvent("click",!0,!0,window,1,r.screenX,r.screenY,r.clientX,r.clientY,!1,!1,!1,!1,0,null),n.forwardedTouchEvent=!0,e.dispatchEvent(n),!0)},FastClick.prototype.onTouchStart=function(e){"use strict";var t=e.targetTouches[0];return this.trackingClick=!0,this.trackingClickStart=e.timeStamp,this.targetElement=e.target,this.touchStartX=t.pageX,this.touchStartY=t.pageY,e.timeStamp-this.lastClickTime<200&&e.preventDefault(),!0},FastClick.prototype.touchHasMoved=function(e){"use strict";var t=e.targetTouches[0];return Math.abs(t.pageX-this.touchStartX)>10||Math.abs(t.pageY-this.touchStartY)>10?!0:!1},FastClick.prototype.onTouchMove=function(e){"use strict";if(!this.trackingClick)return!0;if(this.targetElement!==e.target||this.touchHasMoved(e))this.trackingClick=!1,this.targetElement=null;return!0},FastClick.prototype.findControl=function(e){"use strict";return e.control!==undefined?e.control:e.htmlFor?document.getElementById(e.htmlFor):e.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},FastClick.prototype.onTouchEnd=function(e){"use strict";var t,n,r=this.targetElement;if(!this.trackingClick)return!0;if(e.timeStamp-this.lastClickTime<200)return this.cancelNextClick=!0,!0;this.lastClickTime=e.timeStamp,n=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0;if(r.nodeName.toLowerCase()==="label"){t=this.findControl(r);if(t)return r.focus(),this.deviceIsAndroid?!1:(this.maybeSendClick(t,e)&&(this.targetElement=null,e.preventDefault()),!1)}else if(this.needsFocus(r))return e.timeStamp-n>100?(this.targetElement=null,!0):(r.focus(),r.tagName.toLowerCase()!=="select"&&(this.targetElement=null,e.preventDefault()),!1);return this.maybeSendClick(r,e)?(e.preventDefault(),!1):!1},FastClick.prototype.onTouchCancel=function(){"use strict";this.trackingClick=!1,this.targetElement=null},FastClick.prototype.onClick=function(e){"use strict";var t;return e.forwardedTouchEvent?!0:this.targetElement?(t=this.targetElement,this.targetElement=null,e.cancelable?e.target.type==="submit"&&e.detail===0?!0:!this.needsClick(t)||this.cancelNextClick?(this.cancelNextClick=!1,e.stopImmediatePropagation&&e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),!1):!0:!0):!0},FastClick.prototype.destroy=function(){"use strict";var e=this.layer;e.removeEventListener("click",this.onClick,!0),e.removeEventListener("touchstart",this.onTouchStart,!1),e.removeEventListener("touchmove",this.onTouchMove,!1),e.removeEventListener("touchend",this.onTouchEnd,!1),e.removeEventListener("touchcancel",this.onTouchCancel,!1)},typeof define=="function"&&define.amd&&define(function(){"use strict";return FastClick}),typeof module!="undefined"&&module.exports&&(module.exports=function(e){"use strict";return new FastClick(e)},module.exports.FastClick=FastClick);