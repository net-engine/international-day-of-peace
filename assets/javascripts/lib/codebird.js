/**
 * A Twitter library in JavaScript
 *
 * @package codebird
 * @version 2.5.0-dev
 * @author J.M. <me@mynetx.net>
 * @copyright 2010-2013 J.M. <me@mynetx.net>
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
/**
 * Array.indexOf polyfill
 */
Array.indexOf||(Array.prototype.indexOf=function(e,t){for(var n=t||0;n<this.length;n++)if(this[n]==e)return n;return-1});var Codebird=function(){function parse_str(str,array){var glue1="=",glue2="&",array2=String(str).replace(/^&?([\s\S]*?)&?$/,"$1").split(glue2),i,j,chr,tmp,key,value,bracket,keys,evalStr,that=this,fixStr=function(e){return unescape(e).replace(/([\\"'])/g,"\\$1").replace(/\n/g,"\\n").replace(/\r/g,"\\r")};array||(array=this.window);for(i=0;i<array2.length;i++){tmp=array2[i].split(glue1),tmp.length<2&&(tmp=[tmp,""]),key=fixStr(tmp[0]),value=fixStr(tmp[1]);while(key.charAt(0)===" ")key=key.substr(1);key.indexOf("\0")!==-1&&(key=key.substr(0,key.indexOf("\0")));if(key&&key.charAt(0)!=="["){keys=[],bracket=0;for(j=0;j<key.length;j++)if(key.charAt(j)==="["&&!bracket)bracket=j+1;else if(key.charAt(j)==="]"&&bracket){keys.length||keys.push(key.substr(0,bracket-1)),keys.push(key.substr(bracket,j-bracket)),bracket=0;if(key.charAt(j+1)!=="[")break}keys.length||(keys=[key]);for(j=0;j<keys[0].length;j++){chr=keys[0].charAt(j);if(chr===" "||chr==="."||chr==="[")keys[0]=keys[0].substr(0,j)+"_"+keys[0].substr(j+1);if(chr==="[")break}evalStr="array";for(j=0;j<keys.length;j++)key=keys[j],key!==""&&key!==" "||j===0?key="'"+key+"'":key=eval(evalStr+".push([]);")-1,evalStr+="["+key+"]",j!==keys.length-1&&eval("typeof "+evalStr)==="undefined"&&eval(evalStr+" = [];");evalStr+=" = '"+value+"';\n",eval(evalStr)}}}var _oauth_consumer_key=null,_oauth_consumer_secret=null,_oauth_bearer_token=null,_endpoint_base="https://api.twitter.com/",_endpoint=_endpoint_base+"1.1/",_endpoint_oauth=_endpoint_base,_endpoint_proxy="https://api.jublo.net/codebird/",_use_jsonp=typeof navigator!="undefined"&&typeof navigator.userAgent!="undefined"&&(navigator.userAgent.indexOf("Trident/4")>-1||navigator.userAgent.indexOf("Trident/5")>-1||navigator.userAgent.indexOf("MSIE 7.0")>-1),_use_proxy=!0,_oauth_token=null,_oauth_token_secret=null,_version="2.5.0-dev",setConsumerKey=function(e,t){_oauth_consumer_key=e,_oauth_consumer_secret=t},setBearerToken=function(e){_oauth_bearer_token=e},getVersion=function(){return _version},setToken=function(e,t){_oauth_token=e,_oauth_token_secret=t},setUseProxy=function(e){_use_proxy=!!e},__call=function(e,t,n,r){if(typeof t=="undefined")var t={};if(typeof r=="undefined")var r=!1;if(typeof n!="function"&&typeof t=="function")n=t,t={},typeof n=="bool"&&(r=n);else if(typeof n=="undefined")var n=function(e){};switch(e){case"oauth_authenticate":case"oauth_authorize":return this[e](t,n);case"oauth2_token":return this[e](n)}var i={};typeof t=="object"?i=t:parse_str(t,i);var s="",o=e.split("_");for(var u=0;u<o.length;u++)u>0&&(s+="/"),s+=o[u];var a=["screen_name"];for(u=0;u<a.length;u++){var f=a[u].toUpperCase(),l=f.split("_").join("/");s=s.split(l).join(f)}var c=s,h=[];if(h=s.match(/[A-Z_]{2,}/))for(var u=0;u<h.length;u++){var f=h[u],p=f.toLowerCase();c=c.split(f).join(":"+p);if(typeof i[p]=="undefined"){for(j=0;j<26;j++)c=c.split(String.fromCharCode(65+j)).join("_"+String.fromCharCode(97+j));console.warn('To call the templated method "'+c+'", specify the parameter value for "'+p+'".')}s=s.split(f).join(i[p]),delete i[p]}for(u=0;u<26;u++)s=s.split(String.fromCharCode(65+u)).join("_"+String.fromCharCode(97+u)),c=c.split(String.fromCharCode(65+u)).join("_"+String.fromCharCode(97+u));var d=_detectMethod(c,i),v=_detectMultipart(c);return _callApi(d,s,c,i,v,r,n)},oauth_authenticate=function(e,t){typeof e.force_login=="undefined"&&(e.force_login=null),typeof e.screen_name=="undefined"&&(e.screen_name=null),_oauth_token==null&&console.warn("To get the authenticate URL, the OAuth token must be set.");var n=_endpoint_oauth+"oauth/authenticate?oauth_token="+_url(_oauth_token);return e.force_login===!0&&(n+="?force_login=1",e.screen_name!==null&&(n+="&screen_name="+e.screen_name)),t(n),!0},oauth_authorize=function(e,t){typeof e.force_login=="undefined"&&(e.force_login=null),typeof e.screen_name=="undefined"&&(e.screen_name=null),_oauth_token==null&&console.warn("To get the authorize URL, the OAuth token must be set.");var n=_endpoint_oauth+"oauth/authorize?oauth_token="+_url(_oauth_token);return e.force_login===!0&&(n+="?force_login=1",e.screen_name!==null&&(n+="&screen_name="+e.screen_name)),t(n),!0},oauth2_token=function(e){_oauth_consumer_key==null&&console.warn("To obtain a bearer token, the consumer key must be set.");if(typeof e=="undefined")var e=function(e){};var t="grant_type=client_credentials",n=_endpoint_oauth+"oauth2/token";_use_proxy&&(n=n.replace(_endpoint_base,_endpoint_proxy));var r;try{r=new XMLHttpRequest}catch(i){r=new ActiveXObject("Microsoft.XMLHTTP")}r.open("POST",n,!0),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.setRequestHeader((_use_proxy?"X-":"")+"Authorization","Basic "+base64_encode(_oauth_consumer_key+":"+_oauth_consumer_secret)),r.onreadystatechange=function(){if(r.readyState>=4){var t=12027;try{t=r.status}catch(n){}var i=_parseApiReply("oauth2/token",r.responseText);i.httpstatus=t,t==200&&setBearerToken(i.access_token),e(i)}},r.send(t)},_url=function(e){return typeof e=="array"?array_map([this,"_url"],e):/boolean|number|string/.test(typeof e)?encodeURIComponent(e).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A"):""},_sha1=function(e){return _oauth_consumer_secret==null&&console.warn("To generate a hash, the consumer secret must be set."),typeof b64_hmac_sha1!="function"&&console.warn("To generate a hash, the Javascript SHA1.js must be available."),b64pad="=",b64_hmac_sha1(_oauth_consumer_secret+"&"+(_oauth_token_secret!=null?_oauth_token_secret:""),e)},base64_encode=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n,r,i,s,o,u,a,f,l=0,c=0,h="",p=[];if(!e)return e;do n=e.charCodeAt(l++),r=e.charCodeAt(l++),i=e.charCodeAt(l++),f=n<<16|r<<8|i,s=f>>18&63,o=f>>12&63,u=f>>6&63,a=f&63,p[c++]=t.charAt(s)+t.charAt(o)+t.charAt(u)+t.charAt(a);while(l<e.length);h=p.join("");var d=e.length%3;return(d?h.slice(0,d-3):h)+"===".slice(d||3)},http_build_query=function(e,t,n){var r,i,s=[],o=http_build_query,u=function(e,t,n){var r,i=[];t===!0?t="1":t===!1&&(t="0");if(t!=null){if(typeof t=="object"){for(r in t)t[r]!=null&&i.push(u(e+"["+r+"]",t[r],n));return i.join(n)}if(typeof t!="function")return _url(e)+"="+_url(t);throw new Error("There was an error processing for http_build_query().")}return""};n||(n="&");for(i in e){r=e[i],t&&!isNaN(i)&&(i=String(t)+i);var a=u(i,r,n);a!=""&&s.push(a)}return s.join(n)},_nonce=function(e){if(typeof e=="undefined")var e=8;e<1&&console.warn("Invalid nonce length.");var t="";for(var n=0;n<e;n++){var r=Math.floor(Math.random()*61);t+="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".substring(r,r+1)}return t},_ksort=function(e){var t={},n=[],r,i,s,o=this,u=!1,a={};r=function(e,t){var n=parseFloat(e),r=parseFloat(t),i=n+""===e,s=r+""===t;return i&&s?n>r?1:n<r?-1:0:i&&!s?1:!i&&s?-1:e>t?1:e<t?-1:0};for(s in e)e.hasOwnProperty(s)&&n.push(s);return n.sort(r),n},_clone=function(e){var t={};for(var n in e)typeof e[n]=="object"?t[n]=t(e[n]):t[n]=e[n];return t},_sign=function(e,t,n,r){if(typeof n=="undefined")var n={};if(typeof r=="undefined")var r=!1;_oauth_consumer_key==null&&console.warn("To generate a signature, the consumer key must be set.");var i={consumer_key:_oauth_consumer_key,version:"1.0",timestamp:Math.round((new Date).getTime()/1e3),nonce:_nonce(),signature_method:"HMAC-SHA1"},s={};for(var o in i){var u=i[o];s["oauth_"+o]=_url(u)}_oauth_token!=null&&(s.oauth_token=_url(_oauth_token)),oauth_params=_clone(s);for(var o in n){var u=n[o];s[o]=_url(u)}var a=_ksort(s),f="";for(var l=0;l<a.length;l++){var o=a[l],u=s[o];f+=o+"="+u+"&"}f=f.substring(0,f.length-1);var c=_sha1(e+"&"+_url(t)+"&"+_url(f));n=r?s:oauth_params,n.oauth_signature=c,a=_ksort(n);if(r){var h="";for(var l=0;l<a.length;l++){var o=a[l],u=n[o];h+=o+"="+_url(u)+"&"}return h.substring(0,h.length-1)}var h="OAuth ";for(var l=0;l<a.length;l++){var o=a[l],u=n[o];h+=o+'="'+_url(u)+'", '}return h.substring(0,h.length-2)},_detectMethod=function(e,t){switch(e){case"account/settings":e=t.length?e+"__post":e}var n={};n.GET=["statuses/mentions_timeline","statuses/user_timeline","statuses/home_timeline","statuses/retweets_of_me","statuses/retweets/:id","statuses/show/:id","statuses/oembed","search/tweets","direct_messages","direct_messages/sent","direct_messages/show","friendships/no_retweets/ids","friends/ids","followers/ids","friendships/lookup","friendships/incoming","friendships/outgoing","friendships/show","friends/list","followers/list","account/settings","account/verify_credentials","blocks/list","blocks/ids","users/lookup","users/show","users/search","users/contributees","users/contributors","users/profile_banner","users/suggestions/:slug","users/suggestions","users/suggestions/:slug/members","favorites/list","lists/list","lists/statuses","lists/memberships","lists/subscribers","lists/subscribers/show","lists/members/show","lists/members","lists/show","lists/subscriptions","saved_searches/list","saved_searches/show/:id","geo/id/:place_id","geo/reverse_geocode","geo/search","geo/similar_places","trends/place","trends/available","trends/closest","oauth/authenticate","oauth/authorize","help/configuration","help/languages","help/privacy","help/tos","application/rate_limit_status"],n.POST=["statuses/destroy/:id","statuses/update","statuses/retweet/:id","statuses/update_with_media","direct_messages/destroy","direct_messages/new","friendships/create","friendships/destroy","friendships/update","account/settings__post","account/update_delivery_device","account/update_profile","account/update_profile_background_image","account/update_profile_colors","account/update_profile_image","blocks/create","blocks/destroy","account/update_profile_banner","account/remove_profile_banner","favorites/destroy","favorites/create","lists/members/destroy","lists/subscribers/create","lists/subscribers/destroy","lists/members/create_all","lists/members/create","lists/destroy","lists/update","lists/create","lists/members/destroy_all","saved_searches/create","saved_searches/destroy/:id","geo/place","users/report_spam","oauth/access_token","oauth/request_token","oauth2/token","oauth2/invalidate_token"];for(var r in n)if(n[r].indexOf(e)>-1)return r;console.warn("Can't find HTTP method to use for \""+e+'".')},_detectMultipart=function(e){var t=["statuses/update_with_media","account/update_profile_background_image","account/update_profile_image","account/update_profile_banner"];return t.indexOf(e)>-1},_buildMultipart=function(e,t){if(!_detectMultipart(e))return;var n=["statuses/update_with_media","account/update_profile_background_image","account/update_profile_image","account/update_profile_banner"],r={"statuses/update_with_media":"media[]","account/update_profile_background_image":"image","account/update_profile_image":"image","account/update_profile_banner":"banner"};if(n.indexOf(e)==-1)return;var r=r[e].split(" "),i="--------------------"+_nonce(),s="";for(var o in t)s+="--"+i+"\r\n"+'Content-Disposition: form-data; name="'+o+'"',r.indexOf(o)>-1&&(s+="\r\nContent-Transfer-Encoding: base64"),s+="\r\n\r\n"+t[o]+"\r\n";return s+="--"+i+"--",s},_getEndpoint=function(e,t){if(e.substring(0,5)=="oauth")var n=_endpoint_oauth+e;else var n=_endpoint+e+".json";return n},_callApi=function(e,t,n,r,i,s,o){if(typeof r=="undefined")var r={};if(typeof i=="undefined")var i=!1;if(typeof s=="undefined")var s=!1;if(typeof o!="function")var o=function(e){};var u=_getEndpoint(t,n),a=null,f;try{f=new XMLHttpRequest}catch(l){f=new ActiveXObject("Microsoft.XMLHTTP")}if(e=="GET"){var c=u;JSON.stringify(r)!="{}"&&(c+="?"+http_build_query(r)),a=_sign(e,u,r);if(_use_jsonp){JSON.stringify(r)!="{}"?c+="&":c+="?";var h=_nonce();window[h]=function(e){e.httpstatus=200,o(e)},r.callback=h,c=u+"?"+_sign(e,u,r,!0);var p=document.createElement("script");p.type="text/javascript",p.src=c;var d=document.getElementsByTagName("body")[0];d.appendChild(p);return}_use_proxy&&(c=c.replace(_endpoint_base,_endpoint_proxy)),f.open(e,c,!0)}else{if(_use_jsonp){console.warn("Sending POST requests is not supported for IE7-9.");return}i?(a=_sign(e,u,{}),r=_buildMultipart(t,r)):(a=_sign(e,u,r),r=http_build_query(r)),post_fields=r;if(_use_proxy||i)u=u.replace(_endpoint_base,_endpoint_proxy);f.open(e,u,!0),i?f.setRequestHeader("Content-Type","multipart/form-data; boundary="+post_fields.split("\r\n")[0].substring(2)):f.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}if(s){_oauth_consumer_key==null&&console.warn("To make an app-only auth API request, the consumer key must be set.");if(_oauth_bearer_token==null)return oauth2_token(function(u){_callApi(e,t,n,r,i,s,o)});a="Bearer "+_oauth_bearer_token}return a!==null&&f.setRequestHeader((_use_proxy?"X-":"")+"Authorization",a),f.onreadystatechange=function(){if(f.readyState>=4){var e=12027;try{e=f.status}catch(t){}var r=_parseApiReply(n,f.responseText);r.httpstatus=e,o(r)}},f.send(e=="GET"?null:post_fields),!0},_parseApiReply=function(e,t){if(t=="[]")return[];var n=!1;try{n=JSON.parse(t)}catch(r){n={};if(t.indexOf('<?xml version="1.0" encoding="UTF-8"?>')===0)n.request=t.match(/<request>(.*)<\/request>/)[1],n.error=t.match(/<error>(.*)<\/error>/)[1];else{var i=t.split("&");for(var s=0;s<i.length;s++){var o=i[s].split("=",2);o.length>1?n[o[0]]=unescape(o[1]):n[o[0]]=null}}}return n};return{setConsumerKey:setConsumerKey,getVersion:getVersion,setToken:setToken,setBearerToken:setBearerToken,setUseProxy:setUseProxy,__call:__call,oauth_authenticate:oauth_authenticate,oauth_authorize:oauth_authorize,oauth2_token:oauth2_token}};